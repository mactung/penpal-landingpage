(function ($) {
    'use strict';
    jQuery(document).ready(function () {
        jQuery(".cvca-carousel").each(function () {
            var data = JSON.parse(jQuery(this).attr('data-config'));
            var item = data['item'];
            var pag = false;
            if (data['pagination'] != undefined && data['pagination'] == 'true') {
                pag = true;
            }
            var nav = false;
            if (data['navigation'] != undefined && data['navigation'] == 'true') {
                nav = true;
            }
            var wrap = data['wrap'] != undefined ? data['wrap'] : '';
            var wrapcaroul = wrap != '' ? jQuery(this).find(wrap) : jQuery(this);
            wrapcaroul.slick({
                slidesToShow: item,
                slidesToScroll: item > 5 ? Math.round(item / 2) : 1,
                arrows: nav,
                dots: pag,
                autoplay: true,
                prevArrow: '<span class="cvca-carousel-btn prev-item"><i class="cs-font clever-icon-arrow-left-1"></i></span>',
                nextArrow: '<span class="cvca-carousel-btn next-item "><i class="cs-font clever-icon-arrow-right-1"></i></span>',
                autoplaySpeed: 5000,
                rtl: $('body.rtl')[0] ? true : false,
                responsive: [
                    {
                        breakpoint: 1024,
                        settings: {
                            slidesToShow: item > 4 ? 4 : item,
                            slidesToScroll: item > 4 ? 2 : 1
                        }
                    }, {
                        breakpoint: 769,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                        }
                    }, {
                        breakpoint: 480,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 1,
                        }
                    }
                ]
            });
        });

        // Pagination
        function zooPaginationAjax(wrap,item,path){
            $(document).on('click','.view-more-button', function(e){
                e.preventDefault();
            });
            if($('.pagination-ajax')[0]){
                
                if($(path)[0]){
                    var button = false;
                    var scrollThreshold = true;
                    if($('.view-more-button')[0]){
                        button = '.view-more-button';
                        scrollThreshold = false;
                        $(document).on('click','.view-more-button', function(){
                            $(this).hide();
                        });
                    }
                    var infScroll = new InfiniteScroll( wrap, {
                        path: path,
                        append: item,
                        status: '.page-load-status',
                        hideNav: '.pagination-ajax',
                        button: button,
                        scrollThreshold: scrollThreshold,
                    });
                    
                    $(wrap).on( 'history.infiniteScroll', function( event, response, path ) {
                        $('.view-more-button').show();
                    });
                    $(wrap).on( 'last.infiniteScroll', function( event, response, path ) {
                        $('.view-more-button').remove();
                    });
                }
                else{
                    $('.pagination-ajax,.infinite-scroll-error,.infinite-scroll-request,.view-more-button').remove();
                }
            }
            
        }
        zooPaginationAjax( '.wrap-loop-content, .products.grid-layout','.post,.product','a.cvca-pagination-next');

        //Parallax js
        if ($('.cvca-parallax-box.in-nav')[0]) {
            var cvca_nav = '';
            var i = 0;
            $('.cvca-parallax-box.in-nav').each(function () {
                cvca_nav += '<li><a href="#' + $(this).attr('id') + '" class="cvca-parallax-nav-item" title="' + $(this).data('title') + '"><span>' + $(this).data('title') + '</span></a></li>';
            });
            cvca_nav = '<ul class="cvca-parallax-nav">' + cvca_nav + '</ul>';
            $('.page-content').append(cvca_nav);
            $('.cvca-parallax-nav li:first-child a').addClass('active');
        }
        $('.cvca-parallax-nav a:not(.active)').live('click', function (e) {
            e.preventDefault();
            $('html, body').animate({
                scrollTop: $($(this).attr('href')).offset().top - $('#cvca-header').outerHeight(true)
            }, 500);
            $('.cvca-parallax-nav a.active').removeClass('active');
            $(this).addClass('active');
        })

        //Shortcode video
        $('.cvca-video-button').on('click', function (e) {
            e.preventDefault();
            var url = $(this).attr('href');
            var height = $(this).data('height');
            var width = $(this).data('width');
            var html = '<div class="cvca-video-mask"></div><div class="cvca-wrap-video-popup"><iframe src="' + url + '" height="' + height + '" width="' + width + '" ></iframe></div>';
            $('body').append(html);
        });
        $('.cvca-video-mask').live('click', function () {
            $('.cvca-wrap-video-popup, .cvca-video-mask').fadeOut();
            setTimeout(function () {
                $('.cvca-wrap-video-popup, .cvca-video-mask').remove();
            }, 500)
        });
        //Count Up
        var options = {
            useEasing: true,
            useGrouping: true,
            separator: ',',
            decimal: '.',
            prefix: '',
        };
        jQuery('.cvca-countup').each(function () {
            var data = JSON.parse($(this).attr('data-config'));
            var item = new CountUp(data['countid'], data['start_number'], data['end_number'], data['decimals'], data['duration'], options);
            jQuery(window).bind("scroll", function () {
                if (jQuery('#' + data['wrapid']).ActiveScreen()) {
                    item.start();
                }
            });
        });
        //Auto typing js
        if ($('.cvca-auto-typing')[0]) {
            $('.cvca-auto-typing').each(function () {
                $(this).find(".content-auto-typing").typed({
                    strings: $(this).data('text'),
                    typeSpeed: $(this).data('speed'),
                    startDelay: $(this).data('delay'),
                    showCursor: $(this).data('cursor') != '' ? true : false,
                });
            });
        }

        // Map Shortcode
       $(".cvca-shortcode-maps").each(function() {
           function init() {
               var mapOptions = {
                   scrollwheel: s,
                   zoom: c,
                   center: new google.maps.LatLng(d,e),
                   styles: f
               }
                 , i = document.getElementById(b)
                 , j = new google.maps.Map(i,mapOptions);
               new google.maps.Marker({
                   position: new google.maps.LatLng(d,e),
                   map: j,
                   title: g,
                   icon: h
               })
           }
           var $image = '';

           if ( $(this).data("marker") != '' ) {
               $image = $(this).data("marker");
           } else {
               $image = {
                   url: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
                   // This marker is 20 pixels wide by 32 pixels high.
                   size: new google.maps.Size(20, 32),
                   // The origin for this image is (0, 0).
                   origin: new google.maps.Point(0, 0),
                   // The anchor for this image is the base of the flagpole at (0, 32).
                   anchor: new google.maps.Point(0, 32)
               };
           }

           var b = $(this).data("id"),
            c = $(this).data("zoom"),
            d = $(this).data("latitude1"),
            e = $(this).data("latitude2"),
            f = $(this).data("style"),
            g = $(this).data("title"),
            h = $image,
            s = $(this).data("scroll");
           google.maps.event.addDomListener(window, "load", init)
       });

        jQuery.fn.extend({
            ActiveScreen: function () {
                var itemtop, windowH, scrolltop;
                itemtop = $(this).offset().top;
                windowH = $(window).height();
                scrolltop = $(window).scrollTop();
                if (itemtop < scrolltop + windowH * 2 / 3) {
                    return true;
                }
                else {
                    return false;
                }
            }
        });
    })
})(jQuery)
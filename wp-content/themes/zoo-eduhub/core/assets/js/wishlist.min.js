(function(a,b){'use strict';a.Cookies||console.error("WooCommerce Cookies Jar is not available.");var c=function(){function a(){null===window.localStorage.getItem(this.STORAGE_KEY)&&window.localStorage.setItem(this.STORAGE_KEY,"[]")}return Object.defineProperty(a.prototype,"STORAGE_KEY",{value:"zooWishlistItems",writable:!1,enumerable:!1,configurable:!1}),a.prototype.add=function(a){var b=this.list();if(a=parseInt(a,10),-1===b.indexOf(a)){b.push(a);var c=JSON.stringify(b);return window.localStorage.setItem(this.STORAGE_KEY,c),Cookies.remove(this.STORAGE_KEY),Cookies.set(this.STORAGE_KEY,c),!0}return!1},a.prototype.exists=function(a){var b=this.list();return-1!==b.indexOf(parseInt(a,10))},a.prototype.remove=function(a){var b=parseInt(a,10),c=this.list(),d=c.indexOf(b);if(-1!==d){c.splice(d,1);var e=JSON.stringify(c);return window.localStorage.setItem(this.STORAGE_KEY,e),Cookies.remove(this.STORAGE_KEY),Cookies.set(this.STORAGE_KEY,e),!0}return!1},a.prototype.list=function(){return JSON.parse(window.localStorage.getItem(this.STORAGE_KEY))},a.prototype.clear=function(){window.localStorage.setItem(this.STORAGE_KEY,"[]"),Cookies.remove(this.STORAGE_KEY)},a}(),d=function(){function a(){this.panel=b(".zoo-wishlist-panel"),this.counter=b(".element-header-wishlist .wishlist-counter"),this.addBtn=".add-to-wishlist",this.removeBtn=".remove-from-wishlist",this.browseBtn=".browse-wishlist:not(.redirect-link)",this.panel.length||(this.renderPanel(),this.panel=b(".zoo-wishlist-panel"))}return a.prototype.renderPanel=function(a){a=a?a:"<p>"+zooWishlistCDATA.wishlistIsEmpty+"</p>",this.panel.length?this.panel.find(".zoo-wishlist-panel-inner").html(a):b("body").append("<div class=\"zoo-wishlist-panel zoo-popup-panel\" style=\"display:none\"><div class=\"loading popup-mask-close\"></div><button class=\"zoo-wishlist-panel-close-btn popup-close-btn\" type=\"button\" name=\"close-button\"><i class=\"zoo-icon-close\"></i> </button><div class=\"zoo-wishlist-panel-inner zoo-popup-inner\" style=\"display: none\">"+a+"</div></div></div>")},a.prototype.renderAddButton=function(a){if(!a instanceof jQuery||!a.attr("data-id"))throw new TypeError("Invalid wishlist button. Product ID not found.");a.hasClass("browse-wishlist")&&a.removeClass("browse-wishlist"),a.hasClass("add-to-wishlist")||a.addClass("add-to-wishlist"),a.attr("title",zooWishlistCDATA.addToWishlist),a.html(zooWishlistCDATA.addToWishlistIcon+zooWishlistCDATA.addToWishlist)},a.prototype.renderBrowseButton=function(a){if(!a instanceof jQuery||!a.attr("data-id"))throw new TypeError("Invalid wishlist button. Product ID not found.");a=b(document).find(".zoo-wishlist-button[data-id="+a.attr("data-id")+"]"),a.removeClass("add-to-wishlist"),a.not(".browse-wishlist").addClass("browse-wishlist"),a.attr("title",zooWishlistCDATA.browseWishlist),a.html(zooWishlistCDATA.browseWishlistIcon+zooWishlistCDATA.browseWishlist)},a}(),e=function(){function a(a,b){this.view=b,this.model=a,this.doingAJAX=!1;var c=this.model.list().length;this.view.counter.text(c),1>c?this.view.counter.addClass("zoo-hidden"):this.view.counter.removeClass("zoo-hidden"),this.updateAddButtonsActions(),this.listen()}return a.prototype.sync=function(a){if("zooWishlistItems"===a.key){var c=JSON.parse(window.localStorage.getItem("zooWishlistItems"));b(".wishlist-counter").text(c.length),1>c.length&&b(".wishlist-counter").addClass("zoo-hidden")}},a.prototype.maybeFetchVariationId=function(){var a=this,c=b("input[name=\"variation_id\"]");c.length&&c.on("change",function(){var d=a.model.list(),e=parseInt(c.val()),f=b(this).parent().find(".zoo-wishlist-button");e&&(f.attr("data-id",e),-1===d.indexOf(e)?!f.hasClass(a.view.addBtn)&&a.view.renderAddButton(f):a.view.renderBrowseButton(f))})},a.prototype.updateAddButtonsActions=function(){var a=this,c=this.model.list();b("body").hasClass("single-product")&&a.maybeFetchVariationId(),b(".add-to-wishlist").each(function(){if(!(!this instanceof HTMLElement)){var d=parseInt(b(this).attr("data-id"));-1!==c.indexOf(d)&&a.view.renderBrowseButton(b(this))}})},a.prototype.addAction=function(a){var c=b(a.currentTarget),d=c.attr("data-id");if(!(c.hasClass("browse-wishlist")&&c.hasClass("redirect-link"))){if(a.preventDefault(),c.hasClass("browse-wishlist"))return this.browseAction(a);if(this.model.exists(d))return void this.view.renderBrowseButton(c);if(!this.model.add(d))alert(zooWishlistCDATA.addToWishlistErr);else if(this.view.renderBrowseButton(c),this.view.counter.removeClass("zoo-hidden"),this.view.counter.text(this.model.list().length),c.hasClass("redirect-link"))b(document).find(".zoo-product-popup-notice")[0]?b(document).find(".zoo-product-popup-notice").addClass("active"):(b("body").append("<div class=\"zoo-product-popup-notice\">"+c.data("label-added")+"</div>"),setTimeout(function(){b(document).find(".zoo-product-popup-notice").addClass("active")},100)),setTimeout(function(){b(document).find(".zoo-product-popup-notice").removeClass("active")},1200);else return this.browseAction(a)}},a.prototype.removeAction=function(a){a.preventDefault();var c=b(a.currentTarget).attr("data-id"),d=b(".zoo-wishlist-button[data-id=\""+c+"\"]"),e=this.model.remove(c);if(d.length&&this.view.renderAddButton(d),e){var f=this.model.list().length;f?this.view.panel.find("#wishlist-item-row-"+c).remove():this.view.renderPanel("<p>"+zooWishlistCDATA.wishlistIsEmpty+"</p>"),this.view.counter.text(f),1>f&&this.view.counter.addClass("zoo-hidden")}},a.prototype.browseAction=function(a){a.preventDefault();var c=this,d=this.model.list();c.view.panel.fadeIn(),d.length&&!this.doingAJAX?(this.doingAJAX=!0,b.ajax({method:"POST",url:ajaxurl,data:{action:"zoo_get_wishlist_products",wishlistItems:JSON.stringify(d)}}).done(function(a){c.doingAJAX=!1,c.view.renderPanel(a.html),c.view.removeBtn=".remove-from-wishlist",b(document).on("click",c.view.removeBtn,function(a){c.removeAction(a)}),c.view.panel.find(".zoo-wishlist-panel-inner").fadeIn()})):c.view.panel.find(".zoo-wishlist-panel-inner").fadeIn(),b(document).trigger("zoo_browse_wishlist")},a.prototype.listen=function(){var a=this;b(document).on("click",this.view.addBtn,function(b){a.addAction(b)}),b(this.view.removeBtn).length&&b(document).on("click",this.view.removeBtn,function(b){a.removeAction(b)}),b(document).on("click",this.view.browseBtn,function(b){a.browseAction(b)}),this.view.panel.find(".zoo-wishlist-panel-close-btn").on("click",function(){a.view.panel.fadeOut()}),this.view.panel.find(".popup-mask-close").on("click",function(){a.view.panel.fadeOut()}),window.addEventListener("storage",this.sync)},a}();b(document).ready(function(){a.zooWishlist=new e(new c(),new d())})})(window,jQuery);
